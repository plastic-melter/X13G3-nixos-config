input {
  kb_layout = us 
  accel_profile = flat
  follow_mouse = 1
  sensitivity = 0.7
  touchpad {
    natural_scroll = true
  }
  gesture = 3, horizontal, workspace
}

general {
  gaps_in = 5
  gaps_out = 10
  border_size = 2
  col.active_border = rgba(bdc6e4ff) rgba(89b4faff) 135deg  # Lighter purple/blue gradient
  col.inactive_border = rgba(313244aa)  # Softer, more transparent
  # col.active_border = rgba(71609cff) rgba(547294ff) 90deg
  # col.inactive_border = rgba(353047bb)
  # wofi purple: ccc2ff
  # dark purpo: 2b1b3f
  # soft pink: e06c9f
  # nord light: 547294
  # nord dark
  layout = dwindle
}

decoration {
  rounding = 8  # Increased from 4 to match Waybar
  blur {
    enabled = true
    size = 5  # Slightly more blur
    passes = 2  # Better quality
    new_optimizations = true
  }
  drop_shadow = yes  # Enable subtle shadows
  shadow_range = 8
  shadow_render_power = 2
  col.shadow = rgba(0d0e15ee)
  active_opacity = 1.0
  inactive_opacity = 0.90  # Slightly higher for better visibility
}

animations {
  enabled = yes
  bezier = myBezier, 0.05, 0.9, 0.1, 1.05
  animation = windows, 1, 7, myBezier
  animation = windowsOut, 1, 7, default, popin 80%
  animation = border, 1, 10, default
  animation = borderangle, 1, 8, default
  animation = fade, 1, 7, default
  animation = workspaces, 1, 6, default
}

# Tiling
dwindle {
  pseudotile = true
  preserve_split = true
  smart_split = true
}

ecosystem = {
  no_update_news = true
  no_donation_nag = true
  enforce_permissions = false # dont priv-check apps that try to do stuff w/ hyprland

#master {
#  new_is_master = true
#}

# Touchpad gestures
gestures {
#  workspace_swipe = on
#  workspace_swipe_fingers = 3
  workspace_swipe_distance = 500
  workspace_swipe_cancel_ratio = 0.15
}

# Window rules
  # things to float
windowrule = match:class thunar, float on
windowrule = match:class imv, float on
windowrule = match:class pavucontrol, float on
windowrule = match:class org\.pulseaudio\.pavucontrol, float on
windowrule = match:title Lutris, float on
windowrule = match:class vlc, float on
windowrule = match:class org\.kde\.kcolorchooser, float on
windowrule = match:class steam, float on
windowrule = match:class .blueman-manager-wrapped, float on
windowrule = match:class dolphin-emu, float on
  # special kindbinds to launch in float
    # wezterm
windowrule = match:class floating-wezterm, float true
windowrule = match:class floating-wezterm, center true
  # default floating sizes
windowrule = size 1400 1000, match:class floating-wezterm
windowrule = size 1000 1200, match:class thunar
windowrule = size 1920 1200, match:class firefox
windowrule = size 1920 1200, match:class vlc
windowrule = size 1280 800, match:title Lutris
windowrule = size 1280 1400, match:class org\.pulseaudio\.pavucontrol
windowrule = size 1280 800, match:class org\.kde\.kcolorchooser
windowrule = size 600 400, match:class .blueman-manager-wrapped
windowrule = size 1280 800, match:class dolphin-emu

# Setup stuff
  
monitor = eDP-1,3200x2000@120,auto,1
$mod = SUPER
env = XCURSOR_SIZE,16
env = GTK_THEME,Adwaita:dark

# Misc stuff

misc {
  force_default_wallpaper = 0
  disable_hyprland_logo = 1
}

# Hyprexpo plugin

plugin {
  hyprexpo {
    columns = 3
    gap_size = 5
    bg_col = rgb(111111)
    workspace_method = center current 
    enable_gesture = true 
    gesture_fingers = 3
    gesture_distance = 300
    gesture_positive = false
  }
}

# Hyprtrails plugin

plugin {
    hyprtrails {
        color = rgba(ffaa00ff)
    }
}

# Keybinds

  # App launching
#bind = $mod, P, hyprexpo:expo, toggle
bind = $mod, Return, exec, wezterm --config-file /etc/nixos/dotfiles/wezterm/wezterm.lua
bind = $mod SHIFT, Return, exec, wezterm --config-file /etc/nixos/dotfiles/wezterm/wezterm.lua start --always-new-process --class floating-wezterm
bind = $mod, Z, exec, wofi --show drun
bind = $mod SHIFT, Z, exec, nwg-drawer -ovl
bind = $mod SHIFT, L, exec, hyprlock
bind = $mod SHIFT, C, exec, kcolorchooser
bind = $mod SHIFT, C, exec, kcolorchooser
bind = $mod, E, exec, thunar
  # Commands
bind = $mod SHIFT, Q, killactive
bind = $mod SHIFT, E, exec, wlogout
bind = $mod SHIFT, Space, togglefloating
bind = $mod, Space, pseudo
bind = $mod, C, centerwindow
  # Function keys
bind = , Print, exec, hyprshot -m output
bind = $mod, Print, exec, hyprshot -m region
bind = $mod SHIFT, Print, exec, hyprshot -m window
  # WM: switch workspaces
bind = $mod, 1, workspace, 1
bind = $mod, 2, workspace, 2
bind = $mod, 3, workspace, 3
bind = $mod, 4, workspace, 4
bind = $mod, 5, workspace, 5
bind = $mod, Prior, exec, hyprnome --previous
bind = $mod, Next, exec, hyprnome
bind = $mod SHIFT, Prior, exec, hyprnome --previous --move
bind = $mod SHIFT, Next, exec, hyprnome --move
  # WM: change focus
bind = $mod, left, movefocus, l
bind = $mod, right, movefocus, r
bind = $mod, up, movefocus, u
bind = $mod, down, movefocus, d
  # WM: send to workspace
bind = $mod SHIFT, 1, movetoworkspacesilent, 1
bind = $mod SHIFT, 2, movetoworkspacesilent, 2
bind = $mod SHIFT, 3, movetoworkspacesilent, 3
bind = $mod SHIFT, 4, movetoworkspacesilent, 4
bind = $mod SHIFT, 5, movetoworkspacesilent, 5
  # WM: scroll workspaces
bind = $mod, mouse_down, workspace, e-1
bind = $mod, mouse_up, workspace, e+1
  # WM: toggle fullscreen
bind = $mod, f, fullscreen, 
  # WM: swap windows
bind = $mod SHIFT, up, swapwindow, u
bind = $mod SHIFT, down, swapwindow, d
bind = $mod SHIFT, left, swapwindow, l
bind = $mod SHIFT, right, swapwindow, r
  # WM: move windows (floating)
bind = $mod SHIFT, up, moveactive, 0 -100
bind = $mod SHIFT, down, moveactive, 0 100
bind = $mod SHIFT, left, moveactive, -100 0 
bind = $mod SHIFT, right, moveactive, 100 0
  # WM: move/resize with mouse
bindm = $mod, mouse:272, movewindow
bindm = $mod, mouse:273, resizewindow
  # Resize windows using keyboard
binde = $mod CONTROL, up, resizeactive, 0 -50
binde = $mod CONTROL, down, resizeactive, 0 50
binde = $mod CONTROL, left, resizeactive, -50 0
binde = $mod CONTROL, right, resizeactive, 50 0
  # Audio
bind = , XF86AudioMute, exec, /etc/nixos/dotfiles/scripts/mute.sh
bind = , XF86AudioMicMute, exec, /etc/nixos/dotfiles/scripts/micmute.sh
binde = , XF86MonBrightnessUp, exec, /etc/nixos/dotfiles/scripts/brightnessctl.sh up
binde = , XF86MonBrightnessDown, exec, /etc/nixos/dotfiles/scripts/brightnessctl.sh down
binde = , XF86AudioRaiseVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%+
binde = , XF86AudioLowerVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%-

  # Misc
bind = $mod, X, exec, /etc/nixos/dotfiles/scripts/bartoggle.sh
bindl = , switch:[Lid Switch], exec, hyprlock
bind = , XF86Display, exec, /etc/nixos/dotfiles/scripts/screenres.sh
bind = , XF86WLAN, exec, /etc/nixos/dotfiles/scripts/XF86WLAN.sh
bind = , XF86Favorites, exec, nwg-drawer -is 94 -ovl -c 6 -lang ja
bind = , Cancel, exec, wlogout
bind = , XF86Go, exec, /etc/nixos/dotfiles/scripts/XF86Go.sh
bind = , XF86Messenger, exec, /etc/nixos/dotfiles/scripts/XF86Messenger.sh
bind = $mod ALT, e, exec, hyprctl keyword monitor HDMI-A-1,1280x768
bind = $mod, V, exec, nwg-clipman

# Startup programs

#exec-once = /etc/nixos/dotfiles/scripts/wallpaper.sh random
#exec-once = swww-daemon
#exec-once = swww img /etc/nixos/dotfiles/wallpapers/space1.jpg
exec-once = hyprpaper
exec-once = waybar
exec-once = nm-applet
exec-once = dunst
exec-once = fcitx5
exec-once = udiskie -t
exec-once = wl-paste --type text --watch cliphist store
exec-once = wl-paste --type image --watch cliphist store
exec-once = nwg-dock-hyprland -d -p top
exec-once = hyprctl plugin load "$HYPR_PLUGIN_DIR/lib/libhyprexpo.so"
exec-once = /etc/nixos/dotfiles/scripts/homeclean.sh
exec-once = sleep 2 && /etc/nixos/dotfiles/scripts/greeting.sh

# Plugins
#bind = SUPER, p, hyprexpo:expo, toggle
plugin {
    hyprexpo {
        columns = 3
        gap_size = 5
        bg_col = rgb(111111)
        workspace_method = center current # [center/first] [workspace] e.g. first 1 or center m+1

        enable_gesture = true # laptop touchpad
        gesture_fingers = 4  # 3 or 4
        gesture_distance = 300 # how far is the "max"
        gesture_positive = true # positive = swipe down. Negative = swipe up.
    }
}
